<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Employer Sign Up • CaribCareerHub</title>
  <meta name="color-scheme" content="light dark" />
  <link rel="canonical" href="https://carribcareerhub.site/" />

  <style>
    :root{
      --bg:#F3F8FF; --panel:#ffffff; --ink:#0A2458; --muted:#6B7A99;
      --brand:#1E6CFF; --brand-2:#3FA2FF; --accent:#FFA03B;
      --radius:18px; --shadow:0 10px 30px rgba(16,40,120,.12);
      --ring:0 0 0 3px rgba(30,108,255,.12);
    }
    body.dark{
      --bg:#0e1424; --panel:#1c2333; --ink:#f4f6fb; --muted:#aab3cc;
      --brand:#3FA2FF; --brand-2:#1E6CFF; --accent:#ffb44d; --shadow:0 10px 30px rgba(0,0,0,.6);
      --ring:0 0 0 3px rgba(63,162,255,.18);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.55 system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial,sans-serif;transition:background .25s,color .25s}

    /* Header */
    .header{max-width:1100px;margin:0 auto;padding:16px 20px;display:flex;align-items:center;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:10px;min-width:0}
    .brand img{height:40px;width:auto}
    .brand-name{font-weight:900;letter-spacing:.5px;font-size:18px;white-space:nowrap}
    .right{display:flex;align-items:center;gap:10px}
    .theme-toggle{border:1px solid rgba(0,0,0,.08);border-radius:12px;padding:8px 12px;background:var(--panel);color:var(--ink);font-weight:800;cursor:pointer}
    body.dark .theme-toggle{border-color:rgba(255,255,255,.16)}
    .home-link{display:inline-block;padding:8px 12px;border-radius:12px;text-decoration:none;color:#fff;background:linear-gradient(90deg,var(--brand),var(--brand-2));font-weight:800}

    /* Panel */
    .wrap{max-width:1100px;margin:18px auto;padding:0 20px}
    .panel{display:grid;grid-template-columns:1.05fr .95fr;gap:22px}
    @media (max-width:900px){ .panel{grid-template-columns:1fr} }

    .card{background:var(--panel);border:1px solid #e4ecff;border-radius:var(--radius);box-shadow:var(--shadow);padding:22px}
    body.dark .card{border-color:#34405f}

    .hero h1{margin:0 0 10px;font-size:28px;font-weight:900}
    .hero p{margin:0;color:var(--muted)}
    .bullets{margin-top:14px;display:grid;gap:8px}
    .bullets li{list-style:none;background:color-mix(in oklab,var(--panel) 94%, transparent);border:1px solid #e4ecff;border-radius:12px;padding:10px 12px}
    body.dark .bullets li{border-color:#34405f}

    /* Form */
    form{display:grid;gap:12px}
    label{font-size:14px;font-weight:800;color:var(--muted)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:600px){ .row{grid-template-columns:1fr} }
    input,select,textarea{
      width:100%;padding:12px 14px;border-radius:12px;border:1px solid #e4ecff;background:transparent;color:var(--ink);font:16px/1.4 inherit;outline:none
    }
    body.dark input, body.dark select, body.dark textarea{border-color:#34405f}
    input:focus,select:focus,textarea:focus{box-shadow:var(--ring);border-color:color-mix(in oklab,var(--brand) 40%, #e4ecff)}
    .hint{font-size:12px;color:var(--muted);margin-top:2px}

    .actions{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:4px}
    .btn{border:none;border-radius:12px;padding:12px 16px;font-weight:900;cursor:pointer}
    .btn-primary{color:#fff;background:linear-gradient(90deg,var(--brand),var(--brand-2))}
    .btn-line{background:transparent;border:1px solid color-mix(in oklab,var(--ink) 18%, transparent);color:var(--ink)}
    .msg{min-height:20px;font-weight:800}
    .ok{color:#2bd07f}.err{color:#ff6b6b}

    /* Footer */
    .footer{max-width:1100px;margin:20px auto 28px;padding:0 20px;text-align:center;color:var(--muted)}
    .footer a{color:inherit;text-decoration:none;margin:0 10px}
    .footer a:hover{color:var(--brand)}
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="brand">
      <img src="./assets/logo.png" alt="CaribCareerHub logo">
      <div class="brand-name">CARRIBCAREERHUB</div>
    </div>
    <div class="right">
      <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">🌙</button>
      <a class="home-link" href="index.html">Home</a>
    </div>
  </header>

  <div class="wrap panel">
    <!-- Left: Pitch -->
    <section class="card hero">
      <h1>Hire faster with CaribCareerHub</h1>
      <p>Post roles, reach talent across Jamaica, Barbados & Trinidad, and manage applications in one clean dashboard.</p>
      <ul class="bullets">
        <li>🔎 Smart listings that surface to the right candidates</li>
        <li>⚡ Post in minutes, edit anytime, track responses</li>
        <li>🌙 Light & Dark modes for comfy work—day or night</li>
      </ul>
      <p style="margin-top:14px;color:var(--muted)">Already have an account? <a href="login.html" style="font-weight:900;color:var(--brand);text-decoration:none">Sign in</a></p>
    </section>

    <!-- Right: Form -->
    <section class="card">
      <h2 style="margin:0 0 10px;font-size:22px">Create employer account</h2>
      <form id="signupForm" novalidate>
        <div class="row">
          <div>
            <label>Company name</label>
            <input id="company" placeholder="e.g., Blue Wave Studios" required />
          </div>
          <div>
            <label>Contact name</label>
            <input id="contact" placeholder="e.g., Alicia Brown" required />
          </div>
        </div>

        <div class="row">
          <div>
            <label>Email</label>
            <input id="email" type="email" placeholder="you@company.com" required />
          </div>
          <div>
            <label>Password</label>
            <input id="password" type="password" placeholder="Min 8 characters" minlength="8" required />
            <div class="hint">We’ll email a confirmation link.</div>
          </div>
        </div>

        <div class="row">
          <div>
            <label>Location</label>
            <input id="location" placeholder="e.g., Kingston, Jamaica" />
          </div>
          <div>
            <label>Company website</label>
            <input id="website" type="url" placeholder="https://example.com" />
          </div>
        </div>

        <div>
          <label>About the company (optional)</label>
          <textarea id="about" placeholder="What do you do? What makes your team special?" rows="4"></textarea>
        </div>

        <div class="actions">
          <button class="btn btn-primary" type="submit">Create account</button>
          <button class="btn btn-line" type="button" id="toLogin">I already have an account</button>
          <span id="msg" class="msg"></span>
        </div>
      </form>
    </section>
  </div>

  <footer class="footer">
    <nav>
      <a href="about.html">About</a> •
      <a href="contact.html">Contact</a> •
      <a href="privacy.html">Privacy</a> •
      <a href="terms.html">Terms</a>
    </nav>
    © 2025 CaribCareerHub
  </footer>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // Theme boot
    (function(){
      const saved = localStorage.getItem('theme');
      if (saved === 'dark') document.body.classList.add('dark');
      const btn = document.getElementById('themeToggle');
      btn.textContent = document.body.classList.contains('dark') ? '🌞' : '🌙';
      btn.addEventListener('click', ()=>{
        document.body.classList.toggle('dark');
        localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
        btn.textContent = document.body.classList.contains('dark') ? '🌞' : '🌙';
      });
    })();

    // ===== Supabase (uses your existing project) =====
    const SUPABASE_URL = "https://fpytvfhynleaivkvuedt.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZweXR2Zmh5bmxlYWl2a3Z1ZWR0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2NzU1OTAsImV4cCI6MjA3MTI1MTU5MH0.Q7UHLIA_3_o7zCdV-IOthWOYGVVlINDXjp1uF4sdBRk";
    const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // Form wiring
    const form = document.getElementById('signupForm');
    const msg = document.getElementById('msg');
    document.getElementById('toLogin').addEventListener('click', ()=> window.location.href = 'login.html');

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      msg.className = 'msg'; msg.textContent = '';

      // Collect
      const company = document.getElementById('company').value.trim();
      const contact = document.getElementById('contact').value.trim();
      const email   = document.getElementById('email').value.trim();
      const password= document.getElementById('password').value;
      const location= document.getElementById('location').value.trim();
      const website = document.getElementById('website').value.trim();
      const about   = document.getElementById('about').value.trim();

      if (!company || !contact || !email || !password){
        msg.textContent = 'Please fill in all required fields.'; msg.classList.add('err'); return;
      }

      try{
        msg.textContent = 'Creating your account…';

        // Create auth user + store employer details in user metadata
        const meta = { role: 'employer', company_name: company, contact_name: contact, location, website, about };
        const { data, error } = await supabaseClient.auth.signUp({
          email, password, options: { data: meta, emailRedirectTo: window.location.origin + '/dashboard.html' }
        });
        if (error) throw error;

        // Optional: also keep a simple row in an employers table (if you have one)
        // This will no-op if the table doesn't exist, that's fine.
        try {
          await supabaseClient.from('employers').insert([{ email, company_name: company, contact_name: contact, location, website, about }]);
        } catch(_ignore){}

        msg.textContent = '✅ Account created. Check your email to confirm.';
        msg.classList.add('ok');

        // Send them to dashboard with "Manage Posts" tab preselected
        localStorage.setItem('dashTab', 'manage'); // your dashboard reads this key
        setTimeout(()=>{ window.location.href = 'dashboard.html'; }, 800);
      }catch(err){
        console.error(err);
        msg.textContent = '❌ ' + (err.message || 'Sign up failed.');
        msg.classList.add('err');
      }
    });
  </script>
</body>
</html>
